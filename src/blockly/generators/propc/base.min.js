/*
 *   TERMS OF USE: MIT License
 *
 *   Permission is hereby granted, free of charge, to any person obtaining a
 *   copy of this software and associated documentation files (the "Software"),
 *   to deal in the Software without restriction, including without limitation
 *   the rights to use, copy, modify, merge, publish, distribute, sublicense,
 *   and/or sell copies of the Software, and to permit persons to whom the
 *   Software is furnished to do so, subject to the following conditions:
 *
 *   The above copyright notice and this permission notice shall be included in
 *   all copies or substantial portions of the Software.
 *
 *   THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 *   IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 *   FITNESS FOR A PARTICULAR PURPOSE AND NONINFINGEMENT. IN NO EVENT SHALL
 *   THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 *   LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 *   FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
 *   DEALINGS IN THE SOFTWARE.
 */

Blockly.Blocks||(Blockly.Blocks={});
Blockly.Blocks.math_number={init:function(){"Scribbler Robot"===profile.default.description?(this.setHelpUrl(Blockly.MSG_S3_MATH_HELPURL),this.setColour(colorPalette.getColor("math"))):(this.setHelpUrl(Blockly.MSG_VALUES_HELPURL),this.setColour(colorPalette.getColor("programming")));this.setTooltip(Blockly.MSG_MATH_NUMBER_TOOLTIP);this.appendDummyInput("MAIN").appendField(new Blockly.FieldNumber("0",null,null,1),"NUM");this.appendDummyInput("HIDDENVALS").appendField("","RVALS").appendField("","CONN").setVisible(!1);
this.setOutput(!0,"Number");this.connection_id_=null;this.currentInputType="number0"},onchange:function(a){if(a&&(a.type===Blockly.Events.CHANGE||a.type===Blockly.Events.MOVE)){a=["N","-100","100","0"];var b=[-100,100,0],c=this.getFieldValue("NUM");if(this.outputConnection)if(null!==this.outputConnection.targetBlock()){var d,e=this.outputConnection.targetBlock().getInputWithBlock(this).fieldRow;for(d in e)if(e.hasOwnProperty(d)&&!isNaN(parseInt(d,10))){var g=e[d].name||" ";if("RANGEVALS"===g.substring(0,
9)){var f=g;break}}if(d=this.outputConnection.targetBlock())if(f=d.getFieldValue(f))if(a=f.split(","),"S"===a[0]||"R"===a[0]||"A"===a[0])for(f=1;f<=a.length;f++)b[f-1]=Number(a[f]);this.outputConnection.targetBlock().getInputWithBlock(this)!==this.connection_id_&&(f=this.getFieldValue("NUM"),"S"===a[0]?(f=Number(f),f>b[1]&&(f=b[1]),f<b[0]&&(f=b[0]),this.setWarningText(null),this.currentInputType!=="slider"+b[0].toString(10)+"to"+b[1].toString(10)&&(this.getInput("MAIN")&&this.removeInput("MAIN"),
this.appendDummyInput("MAIN").appendField(new Blockly.FieldRange(f.toString(10),b[0].toString(10),b[1].toString(10)),"NUM"),this.currentInputType="slider"+b[0].toString(10)+"to"+b[1].toString(10))):this.currentInputType!=="number"+f&&(this.getInput("MAIN")&&this.removeInput("MAIN"),this.appendDummyInput("MAIN").appendField(new Blockly.FieldNumber(f,null,null,1),"NUM"),this.currentInputType="number"+f));this.connection_id_=this.outputConnection.targetBlock().getInputWithBlock(this)}else this.connection_id_&&
(f=this.getFieldValue("NUM"),this.currentInputType!=="number"+f&&(this.getInput("MAIN")&&this.removeInput("MAIN"),this.appendDummyInput("MAIN").appendField(new Blockly.FieldNumber(f,null,null,1),"NUM"),this.currentInputType="number"+f)),this.connection_id_=null,a=["N","-100","100","0"];b[2]=Number(this.getFieldValue("NUM"));if(a){if("R"===a[0])b[2]<b[0]?this.setWarningText("WARNING: Your value is too small!  It must be greater than or equal to "+b[0].toString(10)):b[2]>b[1]?this.setWarningText("WARNING: Your value is too large!  It must be less than or equal to "+
b[1].toString(10)):this.setWarningText(null);else if("A"===a[0]){d="none";for(f=0;f<b.length;f++)b[2]===Number(a[f])&&(d="match");"none"===d?this.setWarningText("WARNING: The value you entered is not available or not allowed!"):this.setWarningText(null)}else this.setWarningText(null);"R"===a[0]&&(b[2]<b[0]||b[2]>b[1])&&1E7>=Math.abs(b[0]-b[1])?this.getField("TITLE")?2147483647<=b[1]?this.setFieldValue("(\u2265 "+b[0].toString(10)+")","TITLE"):-2147483647>=b[0]?this.setFieldValue("(\u2264"+b[1].toString(10)+
")","TITLE"):Math.abs(b[0])===Math.abs(b[1])?this.setFieldValue("(+/- "+Math.abs(b[0]).toString(10)+")","TITLE"):this.setFieldValue("("+b[0].toString(10)+" to "+b[1].toString(10)+")","TITLE"):(this.getInput("MAIN")&&this.removeInput("MAIN"),this.appendDummyInput("MAIN").appendField(new Blockly.FieldNumber(c,null,null,1),"NUM").appendField("","TITLE"),this.currentInputType="titlenumber"+c):this.getField("TITLE")&&(this.getInput("MAIN")&&this.removeInput("MAIN"),"S"===a[0]?(this.appendDummyInput("MAIN").appendField(new Blockly.FieldRange(c,
b[0].toString(10),b[1].toString(10)),"NUM"),this.currentInputType="slider"+b[0].toString(10)+"to"+b[1].toString(10)):(this.appendDummyInput("MAIN").appendField(new Blockly.FieldNumber(c,null,null,1),"NUM"),this.currentInputType="number"+c));this.setFieldValue(a.toString(),"RVALS")}else this.getField("TITLE")&&(this.getInput("MAIN")&&this.removeInput("MAIN"),this.appendDummyInput("MAIN").appendField(new Blockly.FieldNumber(c,null,null,1),"NUM"),this.currentInputType="number"+c),this.setFieldValue("",
"RVALS"),this.setWarningText(null)}}};Blockly.propc.math_number=function(){var a=window.parseInt(this.getFieldValue("NUM"));return[a,0>a?Blockly.propc.ORDER_UNARY_PREFIX:Blockly.propc.ORDER_ATOMIC]};
Blockly.Blocks.math_arithmetic={init:function(){"Scribbler Robot"===profile.default.description?this.setHelpUrl(Blockly.MSG_S3_MATH_HELPURL):this.setHelpUrl(Blockly.MSG_NUMBERS_HELPURL);this.setTooltip(Blockly.MSG_MATH_ARITHMETIC_TOOLTIP);this.setColour(colorPalette.getColor("math"));this.setOutput(!0,"Number");this.appendValueInput("A").setCheck("Number");this.appendValueInput("B").setCheck("Number").appendField(new Blockly.FieldDropdown([["+"," + "],["\u2212"," - "],["\u00d7"," * "],["\u00f7"," / "],
["% (remainder after division)"," % "],["^ (raise to the power of)"," p "]]),"OP");this.setInputsInline(!0);this.myChildren_="B";this.myConnection_=null;this.setMutator(new Blockly.Mutator(["math_arithmatic_term"]))},mutationToDom:function(){var a=document.createElement("mutation");a.setAttribute("terms",this.myChildren_);return a},domToMutation:function(a){this.myChildren_=a.getAttribute("terms");if(66<this.myChildren_.charCodeAt(0))for(a=67;a<=this.myChildren_.charCodeAt(0);a++)this.appendValueInput(String.fromCharCode(a)).setCheck("Number").appendField(new Blockly.FieldDropdown([["+",
" + "],["\u2212"," - "],["\u00d7"," * "],["\u00f7"," / "],["% (remainder after division)"," % "],["^ (raise to the power of)"," p "]]),"OP"+String.fromCharCode(a))},decompose:function(a){var b=a.newBlock("math_arithmatic_container");b.initSvg();var c=b.getInput("STACK").connection;if(66<this.myChildren_.charCodeAt(0))for(var d=67;d<=this.myChildren_.charCodeAt(0);d++){var e=a.newBlock("math_arithmatic_term");e.initSvg();c.connect(e.previousConnection);c=e.nextConnection}return b},compose:function(a){for(var b=
67;this.getInput(String.fromCharCode(b));)this.removeInput(String.fromCharCode(b)),b++;b=67;for(a=a.getInputTargetBlock("STACK");a;){var c=this.appendValueInput(String.fromCharCode(b)).setCheck("Number").appendField(new Blockly.FieldDropdown([["+"," + "],["\u2212"," - "],["\u00d7"," * "],["\u00f7"," / "],["% (remainder after division)"," % "],["^ (raise to the power of)"," p "]]),"OP"+String.fromCharCode(b));a.valueConnection_&&c.connection.connect(a.valueConnection_);b++;a=a.nextConnection&&a.nextConnection.targetBlock()}this.myChildren_=
String.fromCharCode(b-1)},saveConnections:function(a){a=a.getInputTargetBlock("STACK");for(var b=67;a;){var c=this.getInput(String.fromCharCode(b));a.valueConnection_=c&&c.connection.targetConnection;a=a.nextConnection&&a.nextConnection.targetBlock();b++}}};
Blockly.Blocks.math_arithmatic_container={init:function(){this.setColour(colorPalette.getColor("math"));this.appendDummyInput().appendField("Math");this.appendDummyInput().appendField("  term");this.appendDummyInput().appendField("  term");this.setInputsInline(!1);this.appendStatementInput("STACK");this.contextMenu=!1}};
Blockly.Blocks.math_arithmatic_term={init:function(){this.setColour(colorPalette.getColor("math"));this.appendDummyInput().appendField("term");this.setPreviousStatement(!0,"Block");this.setNextStatement(!0);this.contextMenu=!1}};
Blockly.propc.math_arithmetic=function(){var a=[this.getFieldValue("OP")],b=[Blockly.propc.valueToCode(this,"A",Blockly.propc.ORDER_MULTIPLICATIVE)||"0"];b.push(Blockly.propc.valueToCode(this,"B",Blockly.propc.ORDER_MULTIPLICATIVE)||"0");for(var c="",d=67;90>=d;d++)Blockly.propc.valueToCode(this,String.fromCharCode(d),Blockly.propc.ORDER_MULTIPLICATIVE)?(a.push(this.getFieldValue("OP"+String.fromCharCode(d))),b.push(Blockly.propc.valueToCode(this,String.fromCharCode(d),Blockly.propc.ORDER_MULTIPLICATIVE))):
(a.push(""),b.push(""));a.push("");for(d=0;26>d;d++)if(" p "===a[d])c+="pow("+b[d]+", ";else if(0<d){for(var e="",g=d-1;-1<g;){if(" p "===a[g])e+=")";else break;g--}c+=b[d]+e+a[d]}else c+=b[d],c+=a[d];return[c,Blockly.propc.ORDER_NONE]};
Blockly.Blocks.math_limit={helpUrl:Blockly.MSG_NUMBERS_HELPURL,init:function(){this.setTooltip(Blockly.MSG_MATH_LIMIT_TOOLTIP);this.setColour(colorPalette.getColor("math"));this.appendValueInput("A").setCheck("Number").appendField(new Blockly.FieldDropdown([["highest of"," > "],["lowest of"," < "]]),"OP");this.appendValueInput("B").setCheck("Number").appendField("and");this.setInputsInline(!0);this.setOutput(!0,"Number");this.setPreviousStatement(!1,null);this.setNextStatement(!1,null)}};
Blockly.propc.math_limit=function(){var a=this.getFieldValue("OP"),b=Blockly.propc.valueToCode(this,"A",Blockly.propc.ORDER_ASSIGNMENT)||"0",c=Blockly.propc.valueToCode(this,"B",Blockly.propc.ORDER_ASSIGNMENT)||"0";return["("+b+a+c+" ? "+b+" : "+c+")",Blockly.propc.ORDER_ASSIGNMENT]};
Blockly.Blocks.math_crement={init:function(){"Scribbler Robot"===profile.default.description?this.setHelpUrl(Blockly.MSG_S3_MATH_HELPURL):this.setHelpUrl(Blockly.MSG_NUMBERS_HELPURL);this.setTooltip(Blockly.MSG_MATH_CREMENT_TOOLTIP);this.setColour(colorPalette.getColor("math"));this.appendValueInput("VAR").setCheck("Number").appendField(new Blockly.FieldDropdown([["decrement","--"],["increment","++"]]),"OP");this.setPreviousStatement(!0,"Block");this.setNextStatement(!0)}};
Blockly.propc.math_crement=function(){var a=this.getFieldValue("OP");return(Blockly.propc.valueToCode(this,"VAR",Blockly.propc.ORDER_UNARY_PREFIX)||"0")+a+";\n"};
Blockly.Blocks.math_random={init:function(){"Scribbler Robot"===profile.default.description?this.setHelpUrl(Blockly.MSG_S3_MATH_HELPURL):this.setHelpUrl(Blockly.MSG_NUMBERS_HELPURL);this.setTooltip(Blockly.MSG_MATH_RANDOM_TOOLTIP);this.setColour(colorPalette.getColor("math"));this.appendValueInput("A").setCheck("Number").appendField("random number from");this.appendValueInput("B").setCheck("Number").appendField("to");this.setInputsInline(!0);this.setPreviousStatement(!1,null);this.setNextStatement(!1,
null);this.setOutput(!0,"Number")}};Blockly.propc.math_random=function(){var a=Blockly.propc.valueToCode(this,"A",Blockly.propc.ORDER_ATOMIC)||"1",b=Blockly.propc.valueToCode(this,"B",Blockly.propc.ORDER_ATOMIC)||"100";return["random("+a+", "+b+")",Blockly.propc.ORDER_NONE]};
Blockly.Blocks.math_bitwise={helpUrl:Blockly.MSG_NUMBERS_HELPURL,init:function(){this.setTooltip(Blockly.MSG_MATH_BITWISE_TOOLTIP);this.setColour(colorPalette.getColor("math"));this.appendValueInput("A").setCheck("Number");this.appendDummyInput().appendField(new Blockly.FieldDropdown([["& (bitwise AND)"," & "],["| (bitwise OR)"," | "],["^ (bitwise XOR)"," ^ "],[">> (bitwise right shift)"," >> "],["<< (bitwise left shift)"," << "]]),"OP");this.appendValueInput("B").setCheck("Number");this.setOutput(!0,
"Number");this.setPreviousStatement(!1,null);this.setNextStatement(!1,null)}};Blockly.propc.math_bitwise=function(){var a=Blockly.propc.valueToCode(this,"A",Blockly.propc.ORDER_NONE),b=Blockly.propc.valueToCode(this,"B",Blockly.propc.ORDER_NONE),c=this.getFieldValue("OP");return[a+c+b,Blockly.propc.ORDER_ATOMIC]};
Blockly.Blocks.base_delay={helpUrl:Blockly.MSG_CONTROL_HELPURL,init:function(){this.setTooltip(Blockly.MSG_BASE_DELAY_TOOLTIP);this.setColour(colorPalette.getColor("programming"));this.appendValueInput("DELAY_TIME","Number").appendField("pause (ms)").setCheck("Number");this.setInputsInline(!0);this.setPreviousStatement(!0,"Block");this.setNextStatement(!0,null)}};Blockly.propc.base_delay=function(){return"pause("+(Blockly.propc.valueToCode(this,"DELAY_TIME",Blockly.propc.ORDER_ATOMIC)||"1000")+");\n"};
Blockly.Blocks.string_type_block={helpUrl:Blockly.MSG_VALUES_HELPURL,init:function(){this.setTooltip(Blockly.MSG_STRING_TYPE_BLOCK_TOOLTIP);this.setColour(colorPalette.getColor("programming"));this.appendDummyInput().appendField("\u201c").appendField(new Blockly.FieldTextInput("Hello"),"TEXT").appendField("\u201d");this.setPreviousStatement(!1,null);this.setNextStatement(!1,null);this.setOutput(!0,"String")}};
Blockly.propc.string_type_block=function(){return['"'+this.getFieldValue("TEXT").replace(/"/g,'\\"')+'"',Blockly.propc.ORDER_NONE]};
Blockly.Blocks.char_type_block={helpUrl:Blockly.MSG_VALUES_HELPURL,init:function(){this.setTooltip(Blockly.MSG_CHAR_TYPE_BLOCK_TOOLTIP);this.setColour(colorPalette.getColor("programming"));for(var a=[["32 - space","32"]],b=33;127>b;b++)a.push([b.toString(10)+" - "+String.fromCharCode(b),b.toString(10)]);a.push(["7 - bell","7"]);a.push(["10 - line feed","10"]);a.push(["11 - tab","11"]);a.push(["13 - carriage return","13"]);a.push(["127 - delete","127"]);this.appendDummyInput().appendField("character").appendField(new Blockly.FieldDropdown(a),
"CHAR");this.setPreviousStatement(!1,null);this.setNextStatement(!1,null);this.setOutput(!0,"Number")}};Blockly.propc.char_type_block=function(){return[this.getFieldValue("CHAR"),Blockly.propc.ORDER_NONE]};
Blockly.Blocks.music_note={helpUrl:Blockly.MSG_VALUES_HELPURL,init:function(){this.setTooltip(Blockly.MSG_MUSIC_NOTE_BLOCK_TOOLTIP);this.setColour(colorPalette.getColor("programming"));this.appendDummyInput().appendField("music note").appendField(new Blockly.FieldDropdown([["C","2093.00"],["C\u266f/D\u266d","2217.46"],["D","2349.32"],["D\u266f/E\u266d","2489.02"],["E","2637.02"],["F","2793.83"],["F\u266f/G\u266d","2959.96"],["G","3135.96"],["G\u266f/A\u266d","3322.44"],["A","3520.00"],["A\u266f/B\u266d",
"3729.31"],["B","3951.07"]]),"NOTE").appendField("octave").appendField(new Blockly.FieldDropdown([["1st","0.015625"],["2nd","0.03125"],["3rd","0.0625"],["4th","0.125"],["5th","0.25"],["6th","0.5"],["7th","1"],["8th","2"]]),"OCTAVE");this.setPreviousStatement(!1,null);this.setNextStatement(!1,null);this.setOutput(!0,"Number")}};Blockly.propc.music_note=function(){return[Math.round(parseFloat(this.getFieldValue("NOTE"))*parseFloat(this.getFieldValue("OCTAVE"))).toString(10),Blockly.propc.ORDER_NONE]};
Blockly.Blocks.system_counter={init:function(){this.setTooltip(Blockly.MSG_SYSTEM_COUNTER_TOOLTIP);"Other Propeller Boards"===profile.default.description?(this.setHelpUrl(Blockly.MSG_SYSTEM_HELPURL),this.setColour(colorPalette.getColor("system"))):(this.setColour(colorPalette.getColor("programming")),this.setHelpUrl(Blockly.MSG_VALUES_HELPURL));this.appendDummyInput().appendField("system").appendField(new Blockly.FieldDropdown([["counter","CNT"],["clock frequency","CLKFREQ"]]),"CMD");this.setOutput(!0,
"Number")}};Blockly.propc.system_counter=function(){return[this.getFieldValue("CMD"),Blockly.propc.ORDER_NONE]};Blockly.Blocks.waitcnt={helpUrl:Blockly.MSG_SYSTEM_HELPURL,init:function(){this.setTooltip(Blockly.MSG_WAITCNT_TOOLTIP);this.setColour(colorPalette.getColor("system"));this.appendValueInput("TARGET").setCheck("Number").appendField("Wait until");this.setInputsInline(!0);this.setPreviousStatement(!0,"Block");this.setNextStatement(!0,null)}};
Blockly.propc.waitcnt=function(){return"waitcnt("+Blockly.propc.valueToCode(this,"TARGET",Blockly.propc.ORDER_NONE)+");\n"};
Blockly.Blocks.register_set={helpUrl:Blockly.MSG_SYSTEM_HELPURL,init:function(){this.setTooltip(Blockly.MSG_REGISTER_SET_TOOLTIP);this.setColour(colorPalette.getColor("system"));this.appendValueInput("TARGET").setCheck("Number").appendField("cog").appendField(new Blockly.FieldDropdown([["pin output","OUTA"],["pin direction","DIRA"],["counter A","CTRA"],["counter B","CTRB"],["frequency A","FRQA"],["frequency B","FRQB"],["phase accumulator A","PHSA"],["phase accumulator B","PHSB"]]),"CMD").appendField("register =");
this.setInputsInline(!1);this.setPreviousStatement(!0,"Block");this.setNextStatement(!0,null)}};Blockly.propc.register_set=function(){var a=Blockly.propc.valueToCode(this,"TARGET",Blockly.propc.ORDER_NONE);return this.getFieldValue("CMD")+" = "+a+";\n"};
Blockly.Blocks.register_get={helpUrl:Blockly.MSG_SYSTEM_HELPURL,init:function(){this.setTooltip(Blockly.MSG_REGISTER_GET_TOOLTIP);this.setColour(colorPalette.getColor("system"));this.appendDummyInput().appendField("cog").appendField(new Blockly.FieldDropdown([["pin input","INA"],["pin output","OUTA"],["pin direction","DIRA"],["counter A","CTRA"],["counter B","CTRB"],["frequency A","FRQA"],["frequency B","FRQB"],["phase accumulator A","PHSA"],["phase accumulator B","PHSB"]]),"CMD").appendField("register");
this.setOutput(!0,"Number")}};Blockly.propc.register_get=function(){return[this.getFieldValue("CMD"),Blockly.propc.ORDER_NONE]};
Blockly.Blocks.wait_pin={helpUrl:Blockly.MSG_SYSTEM_HELPURL,init:function(){this.setTooltip(Blockly.MSG_WAIT_PIN_TOOLTIP);this.setColour(colorPalette.getColor("system"));this.appendValueInput("PIN").setCheck("Number").appendField("wait until").appendField(new Blockly.FieldDropdown([["PIN","(1 << x)"],["pin mask","x"]]),"PINTYPE");this.appendValueInput("STATE").setCheck("Number").appendField(new Blockly.FieldDropdown([["is","waitpeq"],["is not","waitpne"]]),"FUNC");this.setInputsInline(!0);this.setPreviousStatement(!0,
null);this.setNextStatement(!0,"Block")}};Blockly.propc.wait_pin=function(){var a=Blockly.propc.valueToCode(this,"PIN",Blockly.propc.ORDER_NONE)||"0",b=Blockly.propc.valueToCode(this,"STATE",Blockly.propc.ORDER_NONE)||"0",c=this.getFieldValue("PINTYPE");return this.getFieldValue("FUNC")+"("+c.replace("1",b).replace("x",a)+", "+c.replace("x",a)+");\n"};
Blockly.Blocks.custom_code={helpUrl:Blockly.MSG_SYSTEM_HELPURL,init:function(){this.setTooltip(Blockly.MSG_CUSTOM_CODE_TOOLTIP);this.setColour("#FF8800");this.setWarningText('WARNING: This block has been deprecated.\nReplace with a "User defined code" block from the Control menu.');this.appendDummyInput().appendField("user code").appendField(new Blockly.FieldTextInput(""),"CODE").appendField("in").appendField(new Blockly.FieldDropdown([["main","main"],["setup","setup"],["definitions","definitions"],
["includes","includes"]]),"LOC");this.setInputsInline(!1);this.setPreviousStatement(!0,"Block");this.setNextStatement(!0,null)}};Blockly.propc.custom_code=function(){var a=this.getFieldValue("LOC"),b=this.getFieldValue("CODE"),c="";"includes"===a?Blockly.definitions_["cCode"+cCode]=b:"setup"===a?Blockly.propc.setups_["cCode"+cCode]=b:"definitions"===a?Blockly.propc.global_vars_["cCode"+cCode]=b:c=b;cCode++;return c};
Blockly.Blocks.string_var_length={helpUrl:Blockly.MSG_STRINGS_HELPURL,init:function(){this.setTooltip(Blockly.MSG_STRING_VAR_LENGTH_TOOLTIP);this.setColour(colorPalette.getColor("math"));this.setInputsInline(!1);this.appendDummyInput().appendField("String variable set size of");this.optionList_=["var"];this.v_list=["MYVALUE","MYVALUE"];this.updateConstMenu();this.updateShape_();this.setPreviousStatement(!0,"Block");this.setNextStatement(!0);this.setMutator(new Blockly.Mutator(["string_var_length_var",
"string_var_length_con"]))},mutationToDom:function(){var a=document.createElement("mutation");a.setAttribute("options",JSON.stringify(this.optionList_));return a},domToMutation:function(a){var b=JSON.parse(a.getAttribute("options"));if(!b||b===[]){b=[];a=parseInt(a.getAttribute("vars")||"1");for(var c=0;c<a;c++)b.push("var")}this.optionList_=b;this.updateConstMenu();this.updateShape_()},decompose:function(a){var b=a.newBlock("string_var_length_container");b.initSvg();for(var c=b.getInput("STACK").connection,
d=0;d<this.optionList_.length;d++){var e=a.newBlock("string_var_length_"+this.optionList_[d]);e.initSvg();c.connect(e.previousConnection);c=e.nextConnection}return b},compose:function(a){var b=a.getInputTargetBlock("STACK");this.optionList_.length=0;for(a=[];b;){var c=b.type.split("_");this.optionList_.push(c[c.length-1]);a.push([b.varName_,b.varLen_]);b=b.nextConnection&&b.nextConnection.targetBlock()}this.updateConstMenu();this.updateShape_();for(b=0;b<this.optionList_.length;b++)void 0!==a[b][0]&&
this.setFieldValue(a[b][0],"VAR_NAME"+b),void 0!==a[b][1]&&this.setFieldValue(a[b][1],"VAR_LEN"+b)},saveConnections:function(a){a=a.getInputTargetBlock("STACK");for(var b=0;a;)a.varName_=this.getFieldValue("VAR_NAME"+b)||Blockly.LANG_VARIABLES_GET_ITEM,a.varLen_=this.getFieldValue("VAR_LEN"+b)||"64",a=a.nextConnection&&a.nextConnection.targetBlock(),b++},updateConstMenu:function(a,b){var c=!0;this.v_list=[];for(var d=Blockly.getMainWorkspace().getAllBlocks(),e=0;e<d.length;e++)"constant_define"===
d[e].type&&(c=d[e].getFieldValue("CONSTANT_NAME"),c===a&&b&&(c=b),c&&this.v_list.push([c,c]),c=!1);c&&this.v_list.push(["MYVALUE","MYVALUE"]);for(d=0;d<this.optionList_.length;d++)"con"===this.optionList_[d]&&(e=this.getFieldValue("VAR_LEN"+d),c=this.getFieldValue("VAR_NAME"+d),this.getInput("VAR"+d)&&this.removeInput("VAR"+d),this.appendDummyInput("VAR"+d).appendField("variable").appendField(new Blockly.FieldVariable(Blockly.LANG_VARIABLES_GET_ITEM),"VAR_NAME"+d).appendField("to").appendField(new Blockly.FieldDropdown(uniq_fast(this.v_list)),
"VAR_LEN"+d).appendField("characters"),this.setFieldValue(c,"VAR_NAME"+d),e&&e===a&&b?this.setFieldValue(b,"VAR_LEN"+d):e&&this.setFieldValue(e,"VAR_LEN"+d))},updateShape_:function(){for(var a=0;this.getInput("VAR"+a);)this.removeInput("VAR"+a),a++;for(a=0;a<this.optionList_.length;a++)"con"===this.optionList_[a]?this.appendDummyInput("VAR"+a).appendField("variable").appendField(new Blockly.FieldVariable(Blockly.LANG_VARIABLES_GET_ITEM),"VAR_NAME"+a).appendField("to").appendField(new Blockly.FieldDropdown(uniq_fast(this.v_list)),
"VAR_LEN"+a).appendField("characters"):this.appendDummyInput("VAR"+a).appendField("variable").appendField(new Blockly.FieldVariable(Blockly.LANG_VARIABLES_GET_ITEM),"VAR_NAME"+a).appendField("to").appendField(new Blockly.FieldNumber("64",null,null,1),"VAR_LEN"+a).appendField("characters")},onchange:function(){for(var a=Blockly.getMainWorkspace().getAllBlocks(),b=0,c=0;c<a.length;c++)"string_var_length"===a[c].type&&b++;1<b?this.setWarningText("WARNING! Only use one of these blocks!"):this.setWarningText(null)}};
Blockly.Blocks.string_var_length_container={init:function(){this.setColour(colorPalette.getColor("math"));this.appendDummyInput().appendField("String variable lengths");this.setInputsInline(!1);this.appendStatementInput("STACK");this.contextMenu=!1}};Blockly.Blocks.string_var_length_var={init:function(){this.setColour(colorPalette.getColor("math"));this.appendDummyInput().appendField("number");this.setPreviousStatement(!0,"Block");this.setNextStatement(!0);this.contextMenu=!1}};
Blockly.Blocks.string_var_length_con={init:function(){this.setColour(colorPalette.getColor("math"));this.appendDummyInput().appendField("named constant");this.setPreviousStatement(!0,"Block");this.setNextStatement(!0);this.contextMenu=!1}};
Blockly.propc.string_var_length=function(){var a=0;for(Blockly.propc.string_var_lengths=[];this.getInput("VAR"+a.toString(10));){var b=this.getFieldValue("VAR_LEN"+a.toString(10)),c="";"con"===this.optionList_[a]&&(c="MY_");Blockly.propc.string_var_lengths.push([this.getFieldValue("VAR_NAME"+a.toString(10)),c+b]);a++}return""};
Blockly.Blocks.string_length={helpUrl:Blockly.MSG_STRINGS_HELPURL,init:function(){this.setTooltip(Blockly.MSG_STRING_LENGTH_TOOLTIP);this.setColour(colorPalette.getColor("math"));this.appendValueInput("VALUE").setCheck("String").appendField("length of string");this.setInputsInline(!0);this.setOutput(!0,"Number");this.setPreviousStatement(!1,null);this.setNextStatement(!1,null)}};
Blockly.propc.string_length=function(){return["((int) strlen("+Blockly.propc.valueToCode(this,"VALUE",Blockly.propc.ORDER_NONE)+"))",Blockly.propc.ORDER_NONE]};
Blockly.Blocks.high_low_value={helpUrl:Blockly.MSG_VALUES_HELPURL,init:function(){this.setTooltip(Blockly.MSG_HIGH_LOW_VALUE_TOOLTIP);this.setColour(colorPalette.getColor("programming"));this.appendDummyInput().appendField(new Blockly.FieldDropdown([["high","1"],["low","0"]]),"VALUE");this.setOutput(!0,"Number");this.setPreviousStatement(!1,null);this.setNextStatement(!1,null)}};Blockly.propc.high_low_value=function(){return[this.getFieldValue("VALUE"),Blockly.propc.ORDER_ATOMIC]};
Blockly.Blocks.comment={helpUrl:Blockly.MSG_CONTROL_HELPURL,init:function(){this.setTooltip(Blockly.MSG_COMMENT_TOOLTIP);this.setColour(colorPalette.getColor("programming"));this.appendDummyInput("MAIN").appendField("add","TITLE").appendField(new Blockly.FieldDropdown([["comment","COMMENT"],["blank separator","SPACER"],["***       ","SPACER"]],function(a){this.sourceBlock_.updateShape_({ACTION:a})}),"ACTION").appendField(new Blockly.FieldTextInput(""),"COMMENT_TEXT");this.setPreviousStatement(!0,
"Block");this.setNextStatement(!0,null)},mutationToDom:function(){var a=document.createElement("mutation"),b=this.getFieldValue("ACTION");a.setAttribute("action",b);return a},domToMutation:function(a){a=a.getAttribute("action");this.updateShape_({ACTION:a})},updateShape_:function(a){var b=a.ACTION;void 0===a.ACTION&&(b=this.getFieldValue("ACTION"));this.getFieldValue("COMMENT_TEXT");this.getInput("MAIN")&&this.removeInput("MAIN");"COMMENT"===b?(this.setColour(colorPalette.getColor("programming")),
this.appendDummyInput("MAIN").appendField("add","TITLE").appendField(new Blockly.FieldDropdown([["comment","COMMENT"],["blank separator","SPACER"]],function(a){this.sourceBlock_.updateShape_({ACTION:a})}),"ACTION").appendField(new Blockly.FieldTextInput(""),"COMMENT_TEXT")):"SPACER"===b&&"#FFFFFF"!==this.getColour&&(this.setColour("#FFFFFF"),this.appendDummyInput("MAIN").appendField("   ","TITLE").appendField(new Blockly.FieldDropdown([["comment","COMMENT"],["       \u25bd       ","SPACER"]],function(a){this.sourceBlock_.updateShape_({ACTION:a})}),
"ACTION").appendField(new Blockly.FieldTextInput(""),"COMMENT_TEXT"),this.setFieldValue("SPACER","ACTION"),this.getField("COMMENT_TEXT").setVisible(!1))}};Blockly.propc.comment=function(){return"// "+this.getFieldValue("COMMENT_TEXT")+"\n"};
Blockly.Blocks.color_picker={helpUrl:Blockly.MSG_VALUES_HELPURL,init:function(){this.setTooltip(Blockly.MSG_COLOR_PICKER_TOOLTIP);this.setColour(colorPalette.getColor("programming"));this.appendDummyInput().appendField("color").appendField((new Blockly.FieldColour("#FFFFFF")).setColours("#FFFFFF #DFDFDF #BFBFBF #9F9F9F #7F7F7F #5F5F5F #3F3F3F #1F1F1F #000000 #FFCCCC #FF9999 #FF6666 #FF3333 #FF0000 #CC0000 #990000 #660000 #330000 #FFE5CC #FFCB99 #FFB166 #FF9733 #FF7D00 #CC6400 #994B00 #663200 #331900 #FFFFCC #FFFF99 #FFFF66 #FFFF33 #FFFF00 #CCCC00 #999900 #666600 #333300 #E5FFCC #CBFF99 #B1FF66 #97FF33 #7DFF00 #64CC00 #4B9900 #326600 #193300 #CCFFCC #99FF99 #66FF66 #33FF33 #00FF00 #00CC00 #009900 #006600 #003300 #CCFFE5 #99FFCB #66FFB1 #33FF97 #00FF7D #00CC64 #00994B #006632 #003319 #CCFFFF #99FFFF #66FFFF #33FFFF #00FFFF #00CCCC #009999 #006666 #003333 #CCE5FF #99CBFF #66B1FF #3397FF #007DFF #0064CC #004B99 #003266 #001933 #CCCCFF #9999FF #6666FF #3333FF #0000FF #0000CC #000099 #000066 #000033 #E5CCFF #CB99FF #B166FF #9733FF #7D00FF #6400CC #4B0099 #320066 #190033 #FFCCFF #FF99FF #FF66FF #FF33FF #FF00FF #CC00CC #990099 #660066 #330033 #FFCCE5 #FF99CB #FF66B1 #FF3397 #FF007D #CC0064 #99004B #660032 #330019".split(" ")).setColumns(9),"COLOR");
this.setPreviousStatement(!1,null);this.setNextStatement(!1,null);this.setOutput(!0,"Number")}};Blockly.propc.color_picker=function(){var a=this.getFieldValue("COLOR");a="0x"+a.substr(1);return[a,Blockly.propc.ORDER_NONE]};
Blockly.Blocks.color_value_from={helpUrl:Blockly.MSG_VALUES_HELPURL,init:function(){this.setTooltip(Blockly.MSG_COLOR_VALUE_FROM_TOOLTIP);this.setColour(colorPalette.getColor("programming"));this.appendDummyInput().appendField("color value from:");this.appendValueInput("RED_VALUE").appendField("R,0,255,0","RANGEVALS0").appendField("red").setCheck("Number");this.appendValueInput("GREEN_VALUE").appendField("R,0,255,0","RANGEVALS1").appendField("green").setCheck("Number");this.appendValueInput("BLUE_VALUE").appendField("R,0,255,0",
"RANGEVALS2").appendField("blue").setCheck("Number");this.getField("RANGEVALS0").setVisible(!1);this.getField("RANGEVALS1").setVisible(!1);this.getField("RANGEVALS2").setVisible(!1);this.setOutput(!0,"Number");this.setInputsInline(!0);this.setPreviousStatement(!1,null);this.setNextStatement(!1,null)}};
Blockly.propc.color_value_from=function(){Blockly.propc.definitions_.colormath='#include "colormath.h"';var a=Blockly.propc.valueToCode(this,"RED_VALUE",Blockly.propc.ORDER_NONE)||"0",b=Blockly.propc.valueToCode(this,"GREEN_VALUE",Blockly.propc.ORDER_NONE)||"0",c=Blockly.propc.valueToCode(this,"BLUE_VALUE",Blockly.propc.ORDER_NONE)||"0";return["getColorRRGGBB("+a+", "+b+", "+c+")",Blockly.propc.ORDER_NONE]};
Blockly.Blocks.get_channel_from={helpUrl:Blockly.MSG_VALUES_HELPURL,init:function(){this.setTooltip(Blockly.MSG_GET_CHANNEL_FROM_TOOLTIP);this.setColour(colorPalette.getColor("programming"));this.appendDummyInput().appendField("get").appendField(new Blockly.FieldDropdown([["Red","R"],["Green","G"],["Blue","B"]]),"CHANNEL");this.appendValueInput("COLOR").appendField("value from").setCheck("Number");this.setOutput(!0,"Number");this.setInputsInline(!0);this.setPreviousStatement(!1,null);this.setNextStatement(!1,
null)}};Blockly.propc.get_channel_from=function(){var a=this.getFieldValue("CHANNEL"),b=Blockly.propc.valueToCode(this,"COLOR",Blockly.propc.ORDER_NONE);Blockly.propc.definitions_.colormath='#include "colormath.h"';return["get8bitColor("+b+', "'+a+'")',Blockly.propc.ORDER_NONE]};
Blockly.Blocks.compare_colors={helpUrl:Blockly.MSG_VALUES_HELPURL,init:function(){this.setTooltip(Blockly.MSG_COMPARE_COLORS_TOOLTIP);this.setColour(colorPalette.getColor("programming"));this.appendDummyInput().appendField("compare");this.appendValueInput("COLOR1").appendField("color 1:").setCheck("Number");this.appendValueInput("COLOR2").appendField("color 2:").setCheck("Number");this.setOutput(!0,"Number");this.setInputsInline(!0);this.setPreviousStatement(!1,null);this.setNextStatement(!1,null)}};
Blockly.propc.compare_colors=function(){var a=Blockly.propc.valueToCode(this,"COLOR1",Blockly.propc.ORDER_NONE)||"0",b=Blockly.propc.valueToCode(this,"COLOR2",Blockly.propc.ORDER_NONE)||"0";Blockly.propc.definitions_.colormath='#include "colormath.h"';return["compareRRGGBB("+a+", "+b+")",Blockly.propc.ORDER_NONE]};
Blockly.Blocks.logic_compare={category:Blockly.LANG_CATEGORY_LOGIC,init:function(){"Scribbler Robot"===profile.default.description?this.setHelpUrl(Blockly.MSG_S3_MATH_HELPURL):this.setHelpUrl(Blockly.MSG_NUMBERS_HELPURL);this.setTooltip(Blockly.MSG_LOGIC_COMPARE_TOOLTIP);this.setColour(colorPalette.getColor("math"));this.setOutput(!0,"Number");this.appendValueInput("A").setCheck("Number");this.appendValueInput("B").setCheck("Number").appendField(new Blockly.FieldDropdown([["=","=="],["\u2260","!="],
["<","<"],["\u2264","<="],[">",">"],["\u2265",">="]]),"OP");this.setInputsInline(!0)}};Blockly.propc.logic_compare=function(){var a=this.getFieldValue("OP"),b="=="===a||"!="===a?Blockly.propc.ORDER_EQUALITY:Blockly.propc.ORDER_RELATIONAL,c=Blockly.propc.valueToCode(this,"A",b)||"0",d=Blockly.propc.valueToCode(this,"B",b)||"0";return[c+" "+a+" "+d,b]};
Blockly.Blocks.logic_operation={category:Blockly.LANG_CATEGORY_LOGIC,init:function(){"Scribbler Robot"===profile.default.description?this.setHelpUrl(Blockly.MSG_S3_MATH_HELPURL):this.setHelpUrl(Blockly.MSG_NUMBERS_HELPURL);this.setTooltip(Blockly.MSG_LOGIC_OPERATION_TOOLTIP);this.setColour(colorPalette.getColor("math"));this.setOutput(!0,"Number");this.appendValueInput("A").setCheck("Number");this.appendValueInput("B").setCheck("Number").appendField(new Blockly.FieldDropdown([["and"," && "],["or",
" || "],["and not"," && !"],["or not"," || !"]]),"OP");this.setInputsInline(!0)}};Blockly.propc.logic_operation=function(){var a=this.getFieldValue("OP"),b=Blockly.propc.ORDER_LOGICAL_AND;if(" || "===a||" || !"===a)b=Blockly.propc.ORDER_LOGICAL_OR;var c=Blockly.propc.valueToCode(this,"A",b)||"0",d=Blockly.propc.valueToCode(this,"B",b)||"0";return[c+" "+a+d,b]};
Blockly.Blocks.parens={init:function(){"Scribbler Robot"===profile.default.description?this.setHelpUrl(Blockly.MSG_S3_MATH_HELPURL):this.setHelpUrl(Blockly.MSG_NUMBERS_HELPURL);this.setTooltip(Blockly.MSG_PARENS_TOOLTIP);this.appendValueInput("BOOL").appendField("(","OP").setCheck("Number");this.appendDummyInput("").appendField(")");this.setInputsInline(!0);this.setColour(colorPalette.getColor("math"));this.setOutput(!0,"Number");this.setInputsInline(!0)}};
Blockly.propc.parens=function(){return["("+(Blockly.propc.valueToCode(this,"BOOL",Blockly.propc.ORDER_ATOMIC)||"0")+")",Blockly.propc.ORDER_ATOMIC]};
Blockly.Blocks.logic_negate={init:function(){"Scribbler Robot"===profile.default.description?this.setHelpUrl(Blockly.MSG_S3_MATH_HELPURL):this.setHelpUrl(Blockly.MSG_NUMBERS_HELPURL);this.setTooltip(Blockly.MSG_LOGIC_NEGATE_TOOLTIP);this.appendValueInput("BOOL").setCheck("Number").appendField(new Blockly.FieldDropdown([["not","!"],["negate","-"],["abs","abs("]]),"OP");this.setColour(colorPalette.getColor("math"));this.setOutput(!0,"Number");this.setInputsInline(!1)}};
Blockly.propc.logic_negate=function(){var a=Blockly.propc.ORDER_UNARY_PREFIX,b=this.getFieldValue("OP"),c=Blockly.propc.valueToCode(this,"BOOL",a)||"0";c=b+c;"abs("===b&&(c+=")",a=Blockly.propc.ORDER_NONE);return[c,a]};
Blockly.Blocks.logic_boolean={helpUrl:Blockly.MSG_VALUES_HELPURL,init:function(){this.setTooltip(Blockly.MSG_LOGIC_BOOLEAN_TOOLTIP);this.setColour(colorPalette.getColor("programming"));this.setOutput(!0,"Number");this.appendDummyInput().appendField(new Blockly.FieldDropdown([["true","TRUE"],["false","FALSE"]]),"BOOL")}};Blockly.propc.logic_boolean=function(){return["TRUE"===this.getFieldValue("BOOL")?"1":"0",Blockly.propc.ORDER_ATOMIC]};
Blockly.Blocks.cog_new={helpUrl:Blockly.MSG_CONTROL_HELPURL,init:function(){this.setTooltip(Blockly.MSG_COG_NEW_TOOLTIP);this.setColour(colorPalette.getColor("programming"));this.appendDummyInput().appendField("new processor");this.appendStatementInput("METHOD").setCheck("Function").appendField("function");this.setInputsInline(!0);this.setPreviousStatement(!0,"Block");this.setNextStatement(!0,null)}};
Blockly.propc.cog_new=function(){var a=Blockly.propc.statementToCode(this,"METHOD"),b=a.replace("  ","").replace("\n","").replace("()","").replace(";",""),c="";2<a.length&&(Blockly.propc.cog_methods_[b]=a,c="cog_run("+b+", 128);\n");return c};
Blockly.Blocks.combine_strings={helpUrl:Blockly.MSG_STRINGS_HELPURL,init:function(){this.setTooltip(Blockly.MSG_COMBINE_STRINGS_TOOLTIP);this.setColour(colorPalette.getColor("math"));this.appendValueInput("STRA").setCheck("String").appendField("combine string");this.appendValueInput("STRB").setCheck("String").appendField("with string");this.appendDummyInput().appendField("store in").appendField(new Blockly.FieldVariable(Blockly.LANG_VARIABLES_GET_ITEM),"VALUE");this.setInputsInline(!0);this.setPreviousStatement(!0,
"Block");this.setNextStatement(!0,null)}};
Blockly.propc.combine_strings=function(){var a=Blockly.propc.valueToCode(this,"STRA",Blockly.propc.ORDER_ATOMIC)||"",b=Blockly.propc.valueToCode(this,"STRB",Blockly.propc.ORDER_ATOMIC)||"",c=Blockly.propc.variableDB_.getName(this.getFieldValue("VALUE"),Blockly.Variables.NAME_TYPE),d="";Blockly.propc.vartype_[c]="char *";return""!==a&&""!==b?d+("sprint("+c+', "%s%s", '+a+", "+b+");\n"):""!==a?d+("strcpy("+c+", "+b+");\n"):""!==b?d+("strcpy("+c+", "+a+");\n"):d+"// Both of the strings to combine are blank!\n"};
Blockly.Blocks.find_substring={helpUrl:Blockly.MSG_STRINGS_HELPURL,init:function(){this.setTooltip(Blockly.MSG_FIND_SUBSTRING_TOOLTIP);"find_substring"===this.type?(this.setColour("#FF8800"),this.setWarningText("WARNING: This block has been deprecated.\nReplace with a new block from the Operators > Numbers menu.\nOld blocks were (1) referenced, new blocks are (0) referenced.")):this.setColour(colorPalette.getColor("math"));this.appendValueInput("SUBSTR").setCheck("String").appendField("find location of text");
this.appendValueInput("STR").setCheck("String").appendField("in string");"find_substring"!==this.type&&this.appendValueInput("LOC").appendField("starting at position");this.setInputsInline(!0);this.setOutput(!0,"Number")}};Blockly.Blocks.find_substring_zero=Blockly.Blocks.find_substring;
Blockly.propc.find_substring=function(){var a=Blockly.propc.valueToCode(this,"SUBSTR",Blockly.propc.ORDER_ATOMIC)||"",b=Blockly.propc.valueToCode(this,"STR",Blockly.propc.ORDER_ATOMIC)||"",c=Blockly.propc.valueToCode(this,"LOC",Blockly.propc.ORDER_ATOMIC)||"0";if("find_substring"===this.type){this.disabled||(Blockly.propc.methods_.find_sub="int find_sub(char *__strS, char *__subS) { char* __pos = strstr(__strS, __subS); return (__pos - __strS + 1); }\n",Blockly.propc.method_declarations_.find_sub=
"int find_sub(char *, char *);\n");var d="// WARNING! THIS BLOCK IS DEPRECATED! \n\n";d=""!==a&&""!==b?d+("find_sub("+b+", "+a+")"):d+"0"}else this.disabled||(Blockly.propc.methods_.find_sub_zero="int str_loc(char *__strS, char *__subS, int __sLoc) { ",Blockly.propc.methods_.find_sub_zero+="__sLoc = constrainInt(__sLoc, 0, (int) strlen(__strS) - 1);\n",Blockly.propc.methods_.find_sub_zero+="char* __pos = strstr(__strS + __sLoc, __subS); return (__pos) ? (__pos - __strS) : -1; }\n",Blockly.propc.method_declarations_.find_sub_zero=
"int str_loc(char *, char *, int);\n"),d="",d=""!==a&&""!==b?d+("str_loc("+b+", "+a+", "+c+")"):d+"0";return[d,Blockly.propc.ORDER_NONE]};Blockly.propc.find_substring_zero=Blockly.propc.find_substring;
Blockly.Blocks.get_char_at_position={helpUrl:Blockly.MSG_STRINGS_HELPURL,init:function(){this.setTooltip(Blockly.MSG_GET_CHAR_AT_POSITION_TOOLTIP);"get_char_at_position"===this.type?(this.setColour("#FF8800"),this.setWarningText("WARNING: This block has been deprecated.\nReplace with a new block from the Operators > Numbers menu.\nOld blocks were (1) referenced, new blocks are (0) referenced.")):this.setColour(colorPalette.getColor("math"));this.appendValueInput("POSITION").setCheck("Number").appendField("get character at position");
this.appendDummyInput().appendField("of").appendField(new Blockly.FieldVariable(Blockly.LANG_VARIABLES_GET_ITEM),"VALUE");this.setInputsInline(!0);this.setOutput(!0,"Number")}};Blockly.Blocks.get_char_at_position_zero=Blockly.Blocks.get_char_at_position;
Blockly.propc.get_char_at_position=function(){var a=Blockly.propc.valueToCode(this,"POSITION",Blockly.propc.ORDER_ATOMIC)||"1",b=Blockly.propc.variableDB_.getName(this.getFieldValue("VALUE"),Blockly.Variables.NAME_TYPE);return["get_char_at_position"===this.type?b+"[("+a+">(int)strlen("+b+")?(int)strlen("+b+"):"+a+")-1]":b+"["+a+"]",Blockly.propc.ORDER_NONE]};Blockly.propc.get_char_at_position_zero=Blockly.propc.get_char_at_position;
Blockly.Blocks.set_char_at_position={helpUrl:Blockly.MSG_STRINGS_HELPURL,init:function(){this.setTooltip(Blockly.MSG_SET_CHAR_AT_POSITION_TOOLTIP);"set_char_at_position"===this.type?(this.setColour("#FF8800"),this.setWarningText("WARNING: This block has been deprecated.\nReplace with a new block from the Operators > Numbers menu.\nOld blocks were (1) referenced, new blocks are (0) referenced.")):this.setColour(colorPalette.getColor("math"));this.appendValueInput("POSITION").setCheck("Number").appendField("set character at position");
this.appendDummyInput().appendField("of string").appendField(new Blockly.FieldVariable(Blockly.LANG_VARIABLES_GET_ITEM),"VALUE");this.appendValueInput("CHAR").setCheck("Number").appendField("to");this.setInputsInline(!0);this.setPreviousStatement(!0,"Block");this.setNextStatement(!0,null)}};Blockly.Blocks.set_char_at_position_zero=Blockly.Blocks.set_char_at_position;
Blockly.propc.set_char_at_position=function(){var a=Blockly.propc.valueToCode(this,"POSITION",Blockly.propc.ORDER_ATOMIC)||"1",b=Blockly.propc.valueToCode(this,"CHAR",Blockly.propc.ORDER_ATOMIC)||"32";if(3!==b.length||"'"!==b[0]||"'"!==b[2])b!==b.replace(/[^0-9]+/g,"")?b="("+b+" & 0xFF)":0<parseInt(b)&&256>parseInt(b)||(b="("+b+" & 0xFF)");var c=Blockly.propc.variableDB_.getName(this.getFieldValue("VALUE"),Blockly.Variables.NAME_TYPE);Blockly.propc.vartype_[c]="char *";return"set_char_at_position"===
this.type?c+"[("+a+">(int)strlen("+c+")?(int)strlen("+c+"):"+a+")-1] = "+b+"\n;":c+"["+a+"] = "+b+"\n;"};Blockly.propc.set_char_at_position_zero=Blockly.propc.set_char_at_position;
Blockly.Blocks.get_substring={helpUrl:Blockly.MSG_STRINGS_HELPURL,init:function(){this.setTooltip(Blockly.MSG_GET_SUBSTRING_TOOLTIP);"get_substring"===this.type?(this.setColour("#FF8800"),this.setWarningText("WARNING: This block has been deprecated.\nReplace with a new block from the Operators > Numbers menu.\nOld blocks were (1) referenced, new blocks are (0) referenced.")):this.setColour(colorPalette.getColor("math"));this.appendDummyInput().appendField("get part of string").appendField(new Blockly.FieldVariable(Blockly.LANG_VARIABLES_GET_ITEM),
"FROM_STR");this.appendValueInput("START").setCheck("Number").appendField("from position");this.appendValueInput("END").setCheck("Number").appendField(new Blockly.FieldDropdown([["thru"," + 1"],["to",""]]),"PART").appendField("position");this.appendDummyInput().appendField("store in").appendField(new Blockly.FieldVariable(Blockly.LANG_VARIABLES_GET_ITEM),"TO_STR");this.setInputsInline(!0);this.setPreviousStatement(!0,"Block");this.setNextStatement(!0,null)}};Blockly.Blocks.get_substring_zero=Blockly.Blocks.get_substring;
Blockly.propc.get_substring=function(){var a=Blockly.propc.valueToCode(this,"START",Blockly.propc.ORDER_ATOMIC)||"1",b=Blockly.propc.valueToCode(this,"END",Blockly.propc.ORDER_ATOMIC)||"2",c=this.getFieldValue("PART"),d=Blockly.propc.variableDB_.getName(this.getFieldValue("FROM_STR"),Blockly.Variables.NAME_TYPE),e=Blockly.propc.variableDB_.getName(this.getFieldValue("TO_STR"),Blockly.Variables.NAME_TYPE);Blockly.propc.vartype_[e]="char *";if(parseInt(a)>parseInt(b)){var g=a;a=b;b=g}g="";"get_substring"===
this.type?(Blockly.propc.definitions_.str_Buffer="char *__scBfr;",g=g+("__stIdx = 0;\nfor(__ssIdx = ("+a+"-1); __ssIdx <= ("+b+" <= (int)strlen("+d)+(")?"+b+":(int)strlen("+d+"))-1; __ssIdx++) {\n__scBfr[__stIdx] = "+d+"[__ssIdx]; __stIdx++; }\n")+"__scBfr[__stIdx] = 0;\n",g+="strcpy("+e+", __scBfr);\n"):(g+="substr ("+e+", "+d+", "+a+", "+b+c+");\n",this.disabled||(Blockly.propc.methods_.substr="void substr(char *__outStr, char *__inStr, int __startPos, int __toPos) {__startPos = (__startPos < 0 ? 0 : (__startPos > strlen(__inStr) ? strlen(__inStr) : __startPos));\n__toPos = (__toPos < 0 ? 0 : (__toPos > strlen(__inStr) ? strlen(__inStr) : __toPos));\nint __idx = ((__toPos < __startPos) ? __startPos : __toPos) - __startPos;\nmemcpy(__outStr, __inStr + __startPos, __idx);\n__outStr[__idx] = 0;}",
Blockly.propc.method_declarations_.substr="void substr (char *, char *, int, int);\n"));return g};Blockly.propc.get_substring_zero=Blockly.propc.get_substring;
Blockly.Blocks.string_compare={helpUrl:Blockly.MSG_STRINGS_HELPURL,init:function(){this.setTooltip(Blockly.MSG_STRING_COMPARE_TOOLTIP);this.setColour(colorPalette.getColor("math"));this.appendValueInput("STRA").setCheck("String").appendField("string");this.appendValueInput("STRB").setCheck("String").appendField(new Blockly.FieldDropdown([["is the same as","=="],["is not the same as","!="],["is alphabetically before","<"],["is alphabetically after",">"]]),"COMP");this.setInputsInline(!0);this.setOutput(!0,
"Number")}};Blockly.propc.string_compare=function(){var a=Blockly.propc.valueToCode(this,"STRA",Blockly.propc.ORDER_ATOMIC)||"",b=Blockly.propc.valueToCode(this,"STRB",Blockly.propc.ORDER_ATOMIC)||"",c=this.getFieldValue("COMP");return""!==a&&""!==b?["(strcmp("+a+", "+b+") "+c+" 0)",Blockly.propc.ORDER_NONE]:["(1"+c+"0)",Blockly.propc.ORDER_NONE]};
Blockly.Blocks.string_to_number={helpUrl:Blockly.MSG_STRINGS_HELPURL,init:function(){this.setTooltip(Blockly.MSG_STRING_TO_NUMBER_TOOLTIP);this.setColour("#FF8800");this.setWarningText("WARNING: This block has been deprecated.\nReplace with a scan string block from the Operators > Numbers menu.");this.appendValueInput("STRING").setCheck("String").appendField("string");this.appendDummyInput().appendField(new Blockly.FieldDropdown([["in decimal","%d"],["in hexadecimal","%x"],["in binary","%b"]]),"TYPE").appendField("to integer store in").appendField(new Blockly.FieldVariable(Blockly.LANG_VARIABLES_GET_ITEM),
"VAR");this.setInputsInline(!0);this.setPreviousStatement(!0,"Block");this.setNextStatement(!0,null)}};Blockly.propc.string_to_number=function(){var a=Blockly.propc.valueToCode(this,"STRING",Blockly.propc.ORDER_ATOMIC)||"0",b=Blockly.propc.variableDB_.getName(this.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE);return"sscan("+a+', "'+this.getFieldValue("TYPE")+'", &'+b+");\n"};
Blockly.Blocks.number_to_string={helpUrl:Blockly.MSG_STRINGS_HELPURL,init:function(){this.setTooltip(Blockly.MSG_NUMBER_TO_STRING_TOOLTIP);this.setColour("#FF8800");this.setWarningText("WARNING: This block has been deprecated.\nReplace with a create string from block from the Operators > Numbers menu.");this.appendValueInput("NUMBER").setCheck("Number").appendField("integer");this.appendDummyInput().appendField("to string in").appendField(new Blockly.FieldDropdown([["decimal","%d"],["hexadecimal",
"%x"],["binary","%b"]]),"TYPE").appendField("store in").appendField(new Blockly.FieldVariable(Blockly.LANG_VARIABLES_GET_ITEM),"VAR");this.setInputsInline(!0);this.setPreviousStatement(!0,"Block");this.setNextStatement(!0,null)}};
Blockly.propc.number_to_string=function(){var a=Blockly.propc.valueToCode(this,"NUMBER",Blockly.propc.ORDER_ATOMIC)||"0",b=Blockly.propc.variableDB_.getName(this.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE);Blockly.propc.vartype_[b]="char *";return"sprint("+b+', "'+this.getFieldValue("TYPE")+'", '+a+");\n"};
Blockly.Blocks.string_split={helpUrl:Blockly.MSG_STRINGS_HELPURL,init:function(){this.setTooltip(Blockly.MSG_STRING_SPLIT_TOOLTIP);this.setColour(colorPalette.getColor("math"));this.appendDummyInput().appendField("split string");this.appendValueInput("FROM_STR").setCheck("String");this.appendValueInput("CHAR").setCheck("Number").appendField("on");this.appendDummyInput().appendField("store the").appendField(new Blockly.FieldDropdown([["first part in","STR"],["next part in","NULL"]],function(a){var b=
!0;"NULL"===a&&(b=!1);this.sourceBlock_.getInput("FROM_STR").setVisible(b)}),"PART").appendField(new Blockly.FieldVariable(Blockly.LANG_VARIABLES_GET_ITEM),"TO_STR");this.setInputsInline(!0);this.setPreviousStatement(!0,"Block");this.setNextStatement(!0,null)}};
Blockly.propc.string_split=function(){var a=Blockly.propc.valueToCode(this,"CHAR",Blockly.propc.ORDER_ATOMIC)||"32",b=Blockly.propc.valueToCode(this,"FROM_STR",Blockly.propc.ORDER_ATOMIC)||'"Hello World!"',c=this.getFieldValue("PART"),d=Blockly.propc.variableDB_.getName(this.getFieldValue("TO_STR"),Blockly.Variables.NAME_TYPE);Blockly.propc.vartype_[d]="char *";"NULL"===c&&(b=c);this.disabled||(Blockly.propc.methods_.str_split="void str_split(char *__fromStr, char *__toStr, char __delim) {\nchar __d[2] = {__delim, 0};\nchar *__token;\n\n__token = strtok(__fromStr, __d);\nstrcpy(__toStr, __token);\n}",
Blockly.propc.method_declarations_.str_split="void str_split(char *, char *, char);\n");return"str_split("+b+", "+d+", "+a+");\n"};
Blockly.Blocks.string_null={helpUrl:Blockly.MSG_STRINGS_HELPURL,init:function(){this.setTooltip(Blockly.MSG_STRING_NULL_TOOLTIP);this.setColour(colorPalette.getColor("math"));this.appendValueInput("STR").appendField("string").setCheck("String");this.appendDummyInput().appendField(new Blockly.FieldDropdown([["is empty","[0] == 0"],["is not empty","[0] != 0"]]),"OP");this.setOutput(!0,"Number")}};
Blockly.propc.string_null=function(){var a=Blockly.propc.valueToCode(this,"STR",Blockly.propc.ORDER_ATOMIC)||'"Hello World!"',b=this.getFieldValue("OP")||"";return[a+b,Blockly.propc.ORDER_NONE]};
Blockly.Blocks.string_trim={helpUrl:Blockly.MSG_STRINGS_HELPURL,init:function(){this.setTooltip(Blockly.MSG_STRING_TRIM_TOOLTIP);this.setColour(colorPalette.getColor("math"));this.appendValueInput("FROM_STR").appendField("trim string");this.appendDummyInput().appendField("store in").appendField(new Blockly.FieldVariable(Blockly.LANG_VARIABLES_GET_ITEM),"TO_STR");this.setInputsInline(!0);this.setPreviousStatement(!0,"Block");this.setNextStatement(!0,null)}};
Blockly.propc.string_trim=function(){var a=Blockly.propc.valueToCode(this,"FROM_STR",Blockly.propc.ORDER_ATOMIC)||'" Hello World! "',b=Blockly.propc.variableDB_.getName(this.getFieldValue("TO_STR"),Blockly.Variables.NAME_TYPE);Blockly.propc.vartype_[b]="char *";Blockly.propc.vartype_[a]="char *";this.disabled||(Blockly.propc.methods_.str_trim="void str_trim(char *out, char *str)\n{\nconst char *end;\n\nwhile(isspace((unsigned char)*str)) str++;\nif(*str == 0)\n{\n*out = 0;\nreturn;\n}\nend = str + (int)strlen(str) - 1;\nwhile(end > str && isspace((unsigned char)*end)) end--;\nend++;\n\nmemcpy(out, str, end - str);\nout[end - str] = 0;\n}",
Blockly.propc.method_declarations_.str_trim="void str_trim(char *, char *);\n");return"str_trim("+b+", "+a+");\n"};
Blockly.Blocks.number_binary={helpUrl:Blockly.MSG_VALUES_HELPURL,init:function(){this.setTooltip(Blockly.MSG_NUMBER_BINARY_TOOLTIP);this.setColour(colorPalette.getColor("programming"));this.appendDummyInput().appendField(new Blockly.FieldTextInput("0101",function(a){if(null===a)return null;a=a.replace(/O/ig,"0");return a=a.replace(/[^0-1]/g,"")}),"NUMBER").appendField("binary");this.setOutput(!0,"Number")}};Blockly.propc.number_binary=function(){return["0b"+this.getFieldValue("NUMBER"),Blockly.propc.ORDER_NONE]};
Blockly.Blocks.number_hex={helpUrl:Blockly.MSG_VALUES_HELPURL,init:function(){this.setTooltip(Blockly.MSG_NUMBER_HEX_TOOLTIP);this.setColour(colorPalette.getColor("programming"));this.appendDummyInput().appendField(new Blockly.FieldTextInput("7F",function(a){if(null===a)return null;a=a.replace(/O/ig,"0");return a=a.replace(/[^0-9A-F]/ig,"").toUpperCase()}),"NUMBER").appendField("hexadecimal");this.setOutput(!0,"Number")}};
Blockly.propc.number_hex=function(){return["0x"+this.getFieldValue("NUMBER"),Blockly.propc.ORDER_NONE]};
Blockly.Blocks.constrain_value={helpUrl:Blockly.MSG_NUMBERS_HELPURL,init:function(){this.setTooltip(Blockly.MSG_CONSTRAIN_VALUE_TOOLTIP);this.setColour(colorPalette.getColor("math"));this.appendValueInput("NUMBER").setCheck("Number").appendField("constrain");this.appendDummyInput().appendField("from").appendField(new Blockly.FieldNumber("0",null,null,1),"MIN").appendField("(min) to").appendField(new Blockly.FieldNumber("100",null,null,1),"MAX").appendField("(max)");this.setInputsInline(!0);this.setOutput(!0,
"Number")}};Blockly.propc.constrain_value=function(){var a=Blockly.propc.valueToCode(this,"NUMBER",Blockly.propc.ORDER_ATOMIC)||"0",b=window.parseInt(this.getFieldValue("MIN")),c=window.parseInt(this.getFieldValue("MAX"));return["constrainInt("+a+", "+b+", "+c+")",Blockly.propc.ORDER_NONE]};
Blockly.Blocks.map_value={helpUrl:Blockly.MSG_NUMBERS_HELPURL,init:function(){this.setTooltip(Blockly.MSG_MAP_VALUE_TOOLTIP);this.setColour(colorPalette.getColor("math"));this.appendValueInput("NUMBER").setCheck("Number").appendField("map");this.appendDummyInput().appendField("with range").appendField(new Blockly.FieldNumber("0",null,null,1),"IMIN").appendField("(from A)").appendField(new Blockly.FieldNumber("50",null,null,1),"IMAX").appendField("(from B) to range").appendField(new Blockly.FieldNumber("0",
null,null,1),"FMIN").appendField("(to A)").appendField(new Blockly.FieldNumber("100",null,null,1),"FMAX").appendField("(to B)");this.setInputsInline(!0);this.setOutput(!0,"Number")}};
Blockly.propc.map_value=function(){var a=Blockly.propc.valueToCode(this,"NUMBER",Blockly.propc.ORDER_ATOMIC)||"0",b=window.parseInt(this.getFieldValue("IMIN")),c=window.parseInt(this.getFieldValue("IMAX")),d=window.parseInt(this.getFieldValue("FMIN")),e=window.parseInt(this.getFieldValue("FMAX"));return["mapInt("+a+","+b+","+c+","+d+","+e+")",Blockly.propc.ORDER_NONE]};
Blockly.Blocks.math_advanced={helpUrl:Blockly.MSG_NUMBERS_HELPURL,init:function(){this.setTooltip(Blockly.MSG_MATH_ADVANCED_TOOLTIP);this.setColour(colorPalette.getColor("math"));this.appendValueInput("ARG1").setCheck("Number");this.appendValueInput("ARG2").setCheck("Number").appendField(new Blockly.FieldDropdown([["\u2715 the cosine of","cos"],["\u2715 the sine of","sin"],["\u2715 the tangent of","tan"],["\u2715 the square root of","sqrt"],["\u2715 e raised to the power of","exp"],["\u2715 the logarithm (base 10) of",
"log10"],["\u2715 the natural logarithm of","log"]]),"OP");this.appendDummyInput("").appendField("store in").appendField(new Blockly.FieldVariable(Blockly.LANG_VARIABLES_GET_ITEM),"STORE");this.setInputsInline(!0);this.setPreviousStatement(!0,"Block");this.setNextStatement(!0,null)}};
Blockly.propc.math_advanced=function(){var a=Blockly.propc.variableDB_.getName(this.getFieldValue("STORE"),Blockly.Variables.NAME_TYPE),b=Blockly.propc.valueToCode(this,"ARG1",Blockly.propc.ORDER_ATOMIC)||"1",c=Blockly.propc.valueToCode(this,"ARG2",Blockly.propc.ORDER_ATOMIC)||"1";b=b.replace(/[\(\-+ ](\d+)/g,"$1.0").replace(/\(int\)/g,"");c=c.replace(/[\(\-+ ](\d+)/g,"$1.0").replace(/\(int\)/g,"");var d=this.getFieldValue("OP"),e="";if("sin"===d||"cos"===d||"tan"===d)e=" * PI/180.0";return a+" = (int) (((float)"+
b+") * "+d+"(((float) "+c+")"+e+"));\n"};
Blockly.Blocks.math_inv_trig={helpUrl:Blockly.MSG_NUMBERS_HELPURL,init:function(){this.setTooltip(Blockly.MSG_MATH_INV_TRIG_TOOLTIP);this.setColour(colorPalette.getColor("math"));this.appendValueInput("ARG1").setCheck("Number").appendField(new Blockly.FieldDropdown([["arcsine of (","asin"],["arccosine of (","acos"],["arctangent of (","atan2"]]),"OP");this.appendValueInput("ARG2").setCheck("Number").appendField("\u00f7");this.appendValueInput("ARG3").appendField(") \u00d7").setCheck("Number");this.appendDummyInput().appendField("store in").appendField(new Blockly.FieldVariable(Blockly.LANG_VARIABLES_GET_ITEM),
"STORE");this.setInputsInline(!0);this.setPreviousStatement(!0,"Block");this.setNextStatement(!0,null)}};
Blockly.propc.math_inv_trig=function(){var a=Blockly.propc.variableDB_.getName(this.getFieldValue("STORE"),Blockly.Variables.NAME_TYPE),b=Blockly.propc.valueToCode(this,"ARG1",Blockly.propc.ORDER_ATOMIC)||"1",c=Blockly.propc.valueToCode(this,"ARG2",Blockly.propc.ORDER_ATOMIC)||"1",d=Blockly.propc.valueToCode(this,"ARG3",Blockly.propc.ORDER_ATOMIC)||"1";b=b.replace(/([0-9])(\xA0| |\)|$)/g,"$1.0$2").replace(/\(int\)/g,"");c=c.replace(/([0-9])(\xA0| |\)|$)/g,"$1.0$2").replace(/\(int\)/g,"");d=d.replace(/([0-9])(\xA0| |\)|$)/g,
"$1.0$2").replace(/\(int\)/g,"");var e=this.getFieldValue("OP"),g="/";"atan2"===e&&(g=",");return a+" = (int) (180.0 * "+e+"(((float) "+b+")"+g+"((float) "+c+")) * "+d+" / PI);\n"};
Blockly.Blocks.constant_define={helpUrl:Blockly.MSG_VALUES_HELPURL,init:function(){this.setTooltip(Blockly.MSG_CONSTANT_DEF_TOOLTIP);this.setColour(colorPalette.getColor("programming"));this.appendDummyInput("MAIN").appendField("constant").appendField(new Blockly.FieldTextInput("MYVALUE",function(a){a=a.toUpperCase();a=a.replace(/ /g,"_").replace(/[^A-Z0-9_]/g,"");this.sourceBlock_.sendConstantVal(this.sourceBlock_.getFieldValue("CONSTANT_NAME"),a);return a}),"CONSTANT_NAME").appendField(" = ").appendField(new Blockly.FieldTextInput("0",
function(a){return a=0===a.indexOf("0x")?a.replace(/[^0-9xA-Fa-f-]/g,""):a.replace(/[^0-9b-]/g,"")}),"VALUE");this.setPreviousStatement(!0,"Block");this.setNextStatement(!0,null);this.sendUpdate=!0},sendConstantVal:function(a,b){if(this.sendUpdate||"-1"===a&&"-1"===b){"-1"===a&&"-1"===b&&(b=a=null);for(var c=Blockly.getMainWorkspace().getAllBlocks(),d=0;d<c.length;d++)c[d]&&c[d].updateConstMenu&&c[d].updateConstMenu.call(c[d],a,b)}this.sendUpdate=!0},onchange:function(a){var b=this.getFieldValue("CONSTANT_NAME"),
c=Blockly.getMainWorkspace().getAllBlocks().toString();if(a.oldXml){var d=(new XMLSerializer).serializeToString(a.oldXml);a=d.indexOf("CONSTANT_NAME");if(-1<a&&-1<d.indexOf("constant_define")){var e=d.indexOf("</field",a);a=d.substring(a+15,e);this.sendConstantVal(a,null)}}d=null;a=c.indexOf("constant "+b+"  =");-1<c.indexOf("constant "+b+"  =",a+1)&&(d='WARNING! you can only define the constant "'+b+'" once!');this.setWarningText(d)}};
Blockly.propc.constant_define=function(){if(!this.disabled){var a=this.getFieldValue("CONSTANT_NAME"),b=this.getFieldValue("VALUE");Blockly.propc.definitions_["USER_"+a]="#define MY_"+a+" \t"+b}return""};
Blockly.Blocks.constant_value={helpUrl:Blockly.MSG_VALUES_HELPURL,init:function(){this.v_list=[];this.setTooltip(Blockly.MSG_CONSTANT_VALUE_TOOLTIP);this.setColour(colorPalette.getColor("programming"));this.appendDummyInput("VALUE_LIST").appendField(new Blockly.FieldDropdown([["MYVALUE","MYVALUE"]]),"VALUE");this.setPreviousStatement(!1,null);this.setNextStatement(!1,null);this.setOutput(!0,null);this.updateConstMenu()},updateConstMenu:function(a,b){var c=!0;this.v_list=[];for(var d=Blockly.getMainWorkspace().getAllBlocks(),
e=0;e<d.length;e++)"constant_define"===d[e].type&&(c=d[e].getFieldValue("CONSTANT_NAME"),c===a&&b&&(c=b),c&&this.v_list.push([c,c]),c=!1);c&&this.v_list.push(["MYVALUE","MYVALUE"]);d=this.getFieldValue("VALUE");this.getInput("VALUE_LIST")&&this.removeInput("VALUE_LIST");this.appendDummyInput("VALUE_LIST").appendField(new Blockly.FieldDropdown(uniq_fast(this.v_list)),"VALUE");d&&d===a&&b?this.setFieldValue(b,"VALUE"):d&&this.setFieldValue(d,"VALUE")},onchange:function(){var a=this.getFieldValue("VALUE");
-1===Blockly.getMainWorkspace().getAllBlocks().toString().indexOf("constant "+a)?this.setWarningText("WARNING: Your program must include a constant define block for this value!"):this.setWarningText(null)}};Blockly.propc.constant_value=function(){return["MY_"+this.getFieldValue("VALUE"),Blockly.propc.ORDER_ATOMIC]};
Blockly.Blocks.custom_code_multiple={helpUrl:Blockly.MSG_SYSTEM_HELPURL,init:function(){this.setTooltip(Blockly.MSG_CUSTOM_CODE_MULTIPLE_TOOLTIP);this.setColour(colorPalette.getColor("system"));this.appendDummyInput().appendField(new Blockly.FieldCheckbox("FALSE",function(a){this.sourceBlock_.hideInputs(a)}),"EDIT").appendField("  User defined code","LABEL");this.buildFields();this.setInputsInline(!1);this.setPreviousStatement(!0,"Block");this.setNextStatement(!0);this.setFieldValue("FALSE","EDIT");
this.hideInputs("FALSE")},buildFields:function(){this.appendDummyInput("SET_LABEL").appendField("label").appendField(new Blockly.FieldTextInput("User defined code",function(a){this.sourceBlock_.setFieldValue("  "+a,"LABEL")}),"LABEL_SET");this.appendDummyInput("SET_COLOR").appendField("block color").appendField((new Blockly.FieldColour("#992673")).setColours("#26994D #268F99 #266999 #264399 #392699 #692699 #8F2699 #992673 #99264C".split(" ")).setColumns(3),"COLOR");this.appendDummyInput("INCL").appendField("includes code").appendField(new Blockly.FieldCode(""),
"INCLUDES");this.appendDummyInput("GLOB").appendField("globals code").appendField(new Blockly.FieldCode(""),"GLOBALS");this.appendDummyInput("SETS").appendField("setups code").appendField(new Blockly.FieldCode(""),"SETUPS");this.appendDummyInput("MAIN").appendField("main code").appendField(new Blockly.FieldCode(""),"MAIN");this.appendDummyInput("OUTS").appendField("main code is").appendField(new Blockly.FieldDropdown([["inline","INL"],["a numeric value","NUM"],["a string value","STR"]],function(a){this.sourceBlock_.setOutputType(a)}),
"TYPE");this.appendDummyInput("FUNC").appendField("functions code").appendField(new Blockly.FieldCode(""),"FUNCTIONS");this.appendDummyInput("ARGS").appendField(new Blockly.FieldDropdown([["no inputs","0"],["add 1 input","1"],["add 2 inputs","2"],["add 3 inputs","3"],["add 4 inputs","4"],["add 5 inputs","5"],["add 6 inputs","6"],["add 7 inputs","7"],["add 8 inputs","8"],["add 9 inputs","9"]],function(a){this.sourceBlock_.setupInputs(a)}),"ARG_COUNT")},mutationToDom:function(){for(var a=document.createElement("mutation"),
b=1;10>b;b++)if(this.getInput("ARG"+b.toString(10))){var c=this.getFieldValue("LABEL_ARG"+b.toString(10));this.setFieldValue(c,"EDIT_ARG"+b.toString(10));this.getField("LABEL_ARG"+b.toString(10)).setVisible(!1)}b=this.getFieldValue("ARG_COUNT")||"0";a.setAttribute("args",b);for(b=1;10>b;b++)this.getField("EDIT_ARG"+b.toString(10))&&a.setAttribute("a"+b.toString(10),this.getFieldValue("EDIT_ARG"+b.toString(10)));a.setAttribute("color",this.getFieldValue("COLOR"));a.setAttribute("type",this.getFieldValue("TYPE"));
return a},domToMutation:function(a){var b=a.getAttribute("args");this.setupInputs(b);for(b=1;10>b;b++){var c=a.getAttribute("a"+b.toString(10));this.getField("EDIT_ARG"+b.toString(10))&&c&&this.setFieldValue(c,"EDIT_ARG"+b.toString(10))}this.setFieldValue(a.getAttribute("color"),"COLOR");a=a.getAttribute("type");this.setOutputType(a);this.setFieldValue("FALSE","EDIT");this.hideInputs("FALSE")},setOutputType:function(a){"INL"===a?(this.setOutput(!1),this.setPreviousStatement(!0),this.setNextStatement(!0)):
"NUM"===a?(this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0,"Number")):(this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0,"String"))},setupInputs:function(a){for(var b=1;b<=Number(a);b++)this.getInput("ARG"+b.toString(10))||this.appendValueInput("ARG"+b.toString(10)).setAlign(Blockly.ALIGN_RIGHT).appendField('input "@'+b.toString(10)+'" label',"EDIT_ARG"+b.toString(10)).appendField(new Blockly.FieldTextInput(""),"LABEL_ARG"+b.toString(10));for(b=9;b>
Number(a);b--)this.getInput("ARG"+b.toString(10))&&this.removeInput("ARG"+b.toString(10))},hideInputs:function(a){var b="SET_LABEL SET_COLOR INCL GLOB SETS MAIN OUTS FUNC ARGS".split(" ");if(!0===a||"true"===a||"TRUE"===a){this.setColour("#909090");for(a=0;a<b.length;a++)this.getInput(b[a]).setVisible(!0);for(b=1;10>b;b++)this.getInput("ARG"+b.toString(10))&&(this.getField("LABEL_ARG"+b.toString(10)).setVisible(!0),a=this.getFieldValue("EDIT_ARG"+b.toString(10)),a!=='input "@'+b.toString(10)+'" label'&&
this.setFieldValue(a,"LABEL_ARG"+b.toString(10)),this.setFieldValue('input "@'+b.toString(10)+'" label',"EDIT_ARG"+b.toString(10)))}else{this.setColour(this.getFieldValue("COLOR"));for(a=0;a<b.length;a++)this.getInput(b[a]).setVisible(!1);for(b=1;10>b;b++)this.getInput("ARG"+b.toString(10))&&(a=this.getFieldValue("LABEL_ARG"+b.toString(10)),this.setFieldValue(a,"EDIT_ARG"+b.toString(10)),this.getField("LABEL_ARG"+b.toString(10)).setVisible(!1))}var c=this;setTimeout(function(){c.render()},200)}};
Blockly.propc.custom_code_multiple=function(){for(var a=[],b=1;10>b;b++)a.push(Blockly.propc.valueToCode(this,"ARG"+b.toString(10),Blockly.propc.ORDER_ATOMIC)||"");b=this.getFieldValue("LABEL");b=encodeURI(b.replace(/ /g,"_")).replace(/[^\w]/g,"_");if(-1!=="0123456789".indexOf(b[0])||"_"===b[0]&&"_"===b[1])b="my_"+b;var c=(this.getFieldValue("INCLUDES")||"").replace(/@([0-9])/g,function(b,c){return a[parseInt(c)-1]}),d=(this.getFieldValue("GLOBALS")||"").replace(/@([0-9])/g,function(b,c){return a[parseInt(c)-
1]}),e=(this.getFieldValue("SETUPS")||"").replace(/@([0-9])/g,function(b,c){return a[parseInt(c)-1]}),g=(this.getFieldValue("MAIN")||"").replace(/@([0-9])/g,function(b,c){return a[parseInt(c)-1]}),f=(this.getFieldValue("FUNCTIONS")||"").replace(/@([0-9])/g,function(b,c){return a[parseInt(c)-1]}),h="";""!==c&&(Blockly.propc.definitions_["cCode"+b]=c+"\n");""!==d&&(Blockly.propc.global_vars_["cCode"+b]=d+"\n");""!==e&&(Blockly.propc.setups_["cCode"+b]=e+"\n");""!==g&&(h+=g);"INL"===this.getFieldValue("TYPE")&&
(h+="\n");""!==f&&(Blockly.propc.methods_["cCode"+b]=f+"\n");return"INL"===this.getFieldValue("TYPE")?h:[h,Blockly.propc.ORDER_ATOMIC]};Blockly.Blocks.propc_file={init:function(){this.setColour("#000000");this.appendDummyInput().appendField(new Blockly.FieldTextInput("single.c"),"FILENAME").appendField(new Blockly.FieldTextInput(""),"CODE");this.setPreviousStatement(!0,null);this.setNextStatement(!0,null)}};
Blockly.propc.propc_file=function(){var a=this.getFieldValue("FILENAME"),b=this.getFieldValue("CODE");-1===b.indexOf(" ")&&-1===b.indexOf("{")&&(b=atob(b));return"// RAW PROPC CODE\n//{{||}}\n"+a+"//{{||}}\n"+b};
